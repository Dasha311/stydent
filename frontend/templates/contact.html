{% load static %}
<!DOCTYPE html>
<html lang="ru" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>NeXus ‚Äî –ß–∞—Ç —Å –ò–ò-–∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç–æ–º</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
<style>
    :root {
      --color-primary: #007AFF; /* Apple blue */
      --color-bg: #F5F5F7; /* Light gray background */
      --color-bg-secondary: #FFFFFF; /* White for cards */
      --color-text: #1D1D1F; /* Dark text */
      --color-text-secondary: #6E6E73; /* Secondary text */
      --color-border: #D2D2D7; /* Subtle border */
      --color-shadow: rgba(0, 0, 0, 0.08); /* Soft shadow */
    }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Inter', sans-serif;
      background-color: var(--color-bg);
      color: var(--color-text);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      line-height: 1.5;
      overflow-wrap: anywhere;
    }
    .text-secondary { color: var(--color-text-secondary); }
    button, a, input {
      transition: all 0.3s ease;
    }
    .card {
      background: rgba(255, 255, 255, 0.9);
      backdrop-filter: blur(10px);
      border: 1px solid var(--color-border);
      border-radius: 18px;
      box-shadow: 0 4px 30px var(--color-shadow);
    }
    button:hover, a:hover {
      transform: translateY(-1px);
    }
    .message {
      max-width: 75%;
      padding: 0.75rem 1.25rem;
      border-radius: 1rem;
      margin-bottom: 1rem;
      font-size: 0.9rem;
      line-height: 1.5;
    }
    .animate-fade-in {
      animation: fade-in 0.3s ease forwards;
    }
    @keyframes fade-in {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    .user-message {
      align-self: flex-end;
      background: var(--color-primary);
      color: #fff;
      border-bottom-right-radius: 0.25rem;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }
    .bot-message {
      align-self: flex-start;
      background: var(--color-bg-secondary);
      border: 1px solid var(--color-border);
      color: var(--color-text);
      border-bottom-left-radius: 0.25rem;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }
    .message-image {
      max-width: 50%;
      padding: 0.25rem;
      border-radius: 0.75rem;
      margin-bottom: 1rem;
      background: var(--color-bg-secondary);
      border: 1px solid var(--color-border);
    }
    .message-image img {
      width: 100%;
      border-radius: 0.5rem;
    }
    .media-preview-item {
      position: relative;
      width: 80px;
      height: 80px;
      border-radius: 0.5rem;
      overflow: hidden;
      border: 1px solid var(--color-border);
    }
    .media-preview-item img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    .media-preview-item button {
      position: absolute;
      top: 0.25rem;
      right: 0.25rem;
      background: rgba(0, 0, 0, 0.5);
      color: #fff;
      border: none;
      border-radius: 50%;
      width: 20px;
      height: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: background 0.3s ease;
    }
    .media-preview-item button:hover {
      background: rgba(0, 0, 0, 0.7);
    }
    @keyframes slide-in {
      from { transform: translateY(20px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
    .animate-slide-in { animation: slide-in 0.3s ease; }
    .test-option {
      background: var(--color-primary);
      color: white;
      border: none;
      border-radius: 0.75rem;
      padding: 0.75rem 1rem;
      margin: 0.25rem;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    .test-option:hover {
      background: #0051CC;
      transform: translateY(-2px);
    }
    .test-question {
      background: var(--color-bg-secondary);
      border: 1px solid var(--color-border);
      border-radius: 1rem;
      padding: 1rem;
      margin-bottom: 1rem;
    }
    .university-button {
      background: var(--color-primary);
      color: white;
      border: none;
      border-radius: 0.75rem;
      padding: 0.5rem 1rem;
      margin: 0.25rem;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 0.8rem;
    }
    .university-button:hover {
      background: #0051CC;
      transform: translateY(-1px);
    }
    #mobile-menu {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease-in-out;
    }
    #mobile-menu.open { max-height: 1000px; }
    #mobile-menu-backdrop {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.3);
      z-index: 40;
      transition: opacity 0.3s ease-in-out;
    }
    #mobile-menu-backdrop.show { display: block; opacity: 1; }
    #mobile-menu a,
    #mobile-menu button {
      font-size: 1.125rem;
      padding: 0.75rem 1.5rem;
      border-radius: 1rem;
      transition: background-color 0.3s ease, color 0.3s ease;
    }
    #mobile-menu a:hover,
    #mobile-menu button:hover {
      color: var(--color-primary);
    }
    #mobile-btn svg {
      width: 28px;
      height: 28px;
      stroke: var(--color-text);
    }
  </style>
</head>
<body class="min-h-screen flex flex-col">
  <!-- Header -->
  <header class="bg-white border-b border-[var(--color-bg-secondary)] sticky top-0 z-50">
    <div class="max-w-7xl mx-auto px-6 py-4 flex justify-between items-center">
      <a href="{% url 'main_menu' %}">
        <img src="{% static 'Icons/Logo.png' %}?v=2" alt="NeXus Logo" class="h-12 md:h-14" />
      </a>
      
      <nav class="hidden md:flex space-x-8 text-sm font-medium">
        <a href="{% url 'main_menu' %}" class="hover:text-[var(--color-primary)]">–ì–ª–∞–≤–Ω–∞—è</a>
        <a href="{% url 'course_view' %}" class="hover:text-[var(--color-primary)]">–í–£–ó—ã</a>
        <a href="{% url 'about' %}" class="hover:text-[var(--color-primary)]">–û –Ω–∞—Å</a>
        <a href="{% url 'contacts' %}" class="text-[var(--color-primary)] font-semibold">–ò–ò - –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç</a>
      </nav>
      
      <div class="hidden md:flex items-center gap-4">
        <a href="#" class="text-[var(--color-primary)] hover:underline text-sm font-medium">–í–æ–π—Ç–∏</a>
        <a href="#" class="bg-[var(--color-primary)] hover:bg-indigo-600 text-white px-4 py-2 rounded-xl text-sm font-semibold transition">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a>
      </div>
      
      <button id="mobile-btn" class="md:hidden" aria-label="–û—Ç–∫—Ä—ã—Ç—å –º–µ–Ω—é" type="button" aria-expanded="false" aria-controls="mobile-menu">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">
          <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16" />
        </svg>
      </button>
    </div>
    
    <div id="mobile-menu-backdrop" tabindex="-1"></div>
    <nav id="mobile-menu" class="md:hidden flex flex-col px-6 pb-6 space-y-4 text-base font-medium bg-white border-t border-[var(--color-bg-secondary)] z-50 relative" aria-label="–ú–æ–±–∏–ª—å–Ω–æ–µ –º–µ–Ω—é">
      <a href="{% url 'main_menu' %}" class="hover:text-[var(--color-primary)]">–ì–ª–∞–≤–Ω–∞—è</a>
      <a href="{% url 'course_view' %}" class="hover:text-[var(--color-primary)]">–í–£–ó—ã</a>
      <a href="{% url 'about' %}" class="hover:text-[var(--color-primary)]">–û –Ω–∞—Å</a>
      <a href="{% url 'contacts' %}" class="text-[var(--color-primary)] font-semibold">–ò–ò - –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç</a>
      <div class="flex flex-col gap-4 mt-4">
        <a href="{% url 'login' %}" class="text-[var(--color-primary)] hover:underline w-full text-center">–í–æ–π—Ç–∏</a>
        <a href="{% url 'register' %}" class="bg-[var(--color-primary)] hover:bg-indigo-600 text-white w-full rounded-xl font-semibold transition py-3 text-center">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a>
      </div>
    </nav>
  </header>

  <!-- Main Content -->
  <main class="max-w-5xl mx-auto px-6 py-12 flex-1">
    <h1 class="text-3xl font-semibold tracking-tight mb-8">–ß–∞—Ç —Å –ò–ò-–∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç–æ–º –ø–æ –ø—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏</h1>
    <div class="card flex flex-col" style="min-height: calc(100vh - 12rem);">
      <div id="chat-container" class="flex-1 p-4 overflow-y-auto space-y-3 bg-[var(--color-bg)] flex flex-col">
        <!-- Messages will be loaded here -->
      </div>
      <div class="p-4 border-t border-[var(--color-border)]">
        <div id="media-preview" class="hidden flex gap-2 mb-4 flex-wrap"></div>
        <form id="chat-form" class="flex gap-2" style="flex-wrap: wrap;">
          <input type="text" id="chat-input" placeholder="–ó–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å –æ –ø—Ä–æ—Ñ–µ—Å—Å–∏—è—Ö, –≤—É–∑–∞—Ö –∏–ª–∏ –ø—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏..." class="flex-grow min-w-[150px] border border-[var(--color-border)] rounded-xl px-4 py-2 focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]" />
          <label for="chat-file" class="cursor-pointer text-[var(--color-primary)] hover:underline flex items-center px-3 shrink-0" title="–ü—Ä–∏–∫—Ä–µ–ø–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ">
            <i class="fas fa-paperclip"></i>
          </label>
          <input type="file" id="chat-file" accept="image/*" style="display:none" multiple />
          <button id="cancel-media" type="button" class="bg-red-500 text-white rounded-xl font-semibold px-4 py-2 shrink-0 min-w-[80px] hover:bg-red-600 shadow-sm hidden">–û—Ç–º–µ–Ω–∞</button>
          <button type="submit" class="bg-[var(--color-primary)] text-white rounded-xl font-semibold px-4 py-2 shrink-0 min-w-[80px] hover:bg-[#0051CC] shadow-sm">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
          <button type="button" id="clear-chat" class="bg-gray-500 text-white rounded-xl font-semibold px-4 py-2 shrink-0 min-w-[80px] hover:bg-gray-600 shadow-sm">–ù–æ–≤—ã–π —á–∞—Ç</button>
        </form>
      </div>
    </div>
  </main>

  <!-- Footer -->
  {% include 'partials/footer.html' %}

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      
      // Mobile Menu
      const btn = document.getElementById('mobile-btn');
      const menu = document.getElementById('mobile-menu');
      const backdrop = document.getElementById('mobile-menu-backdrop');

      function toggleMenu() {
        const isOpen = menu.classList.toggle('open');
        backdrop.classList.toggle('show', isOpen);
        btn.setAttribute('aria-expanded', isOpen);
      }

      btn.addEventListener('click', toggleMenu);
      backdrop.addEventListener('click', toggleMenu);

      // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –ª–æ–≥–æ—Ç–∏–ø–∞ –¥–ª—è –æ–±—Ö–æ–¥–∞ –∫—ç—à–∞
      window.addEventListener('load', function() {
        const logos = document.querySelectorAll('img[alt="NeXus Logo"]');
        logos.forEach(logo => {
          const originalSrc = logo.src.split('?')[0];
          logo.src = originalSrc + '?v=' + new Date().getTime();
        });
      });

      // Chat Functionality
      const chatForm = document.getElementById('chat-form');
      const chatInput = document.getElementById('chat-input');
      const chatContainer = document.getElementById('chat-container');
      const chatFileInput = document.getElementById('chat-file');
      const mediaPreview = document.getElementById('media-preview');
      const cancelMediaButton = document.getElementById('cancel-media');
      const clearChatButton = document.getElementById('clear-chat');

      const stopWords = ['–∏', '–≤', '–Ω–∞', '–ø–æ', '–ª–∏', '—ç—Ç–æ', '–∞', '–∫', '—É', '–∑–∞', '—Ç–æ', '–∂–µ', '–æ—Ç', '—Å', '–±–µ–∑'];
      
      // –ë–ê–ó–ê –î–ê–ù–ù–´–• –£–ù–ò–í–ï–†–°–ò–¢–ï–¢–û–í –ö–ê–ó–ê–•–°–¢–ê–ù–ê
      const universities = {
        "kaznu": {
          name: "–ö–∞–∑–∞—Ö—Å–∫–∏–π –Ω–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç –∏–º. –∞–ª—å-–§–∞—Ä–∞–±–∏ (KazNU / Farabi)",
          military: "–µ—Å—Ç—å (–≤–æ–µ–Ω–Ω–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞, –Ω–∞–±–æ—Ä –ø–æ –∫–æ–Ω–∫—É—Ä—Å—É)",
          scores: "–ø–æ—Ä–æ–≥–æ–≤—ã–µ –±–∞–ª–ª—ã –ï–ù–¢ –≤–∞—Ä—å–∏—Ä—É—é—Ç—Å—è –ø–æ –ø—Ä–æ–≥—Ä–∞–º–º–∞–º (–æ—Ç ~65 –∏ –≤—ã—à–µ)",
          budget: "–µ—Å—Ç—å –±—é–¥–∂–µ—Ç–Ω—ã–µ –º–µ—Å—Ç–∞, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–∫–∞–∑–∞–Ω–æ –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö –ø–æ—Ä–æ–≥–æ–≤—ã—Ö –±–∞–ª–ª–æ–≤",
          directions: "–≥—É–º–∞–Ω–∏—Ç–∞—Ä–Ω—ã–µ –Ω–∞—É–∫–∏, —Ñ–∏–ª–æ–ª–æ–≥–∏—è, —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ –Ω–∞—É–∫–∏, –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –Ω–∞—É–∫–∏, –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞, –òT, —ç–∫–æ–Ω–æ–º–∏–∫–∞, —é—Ä–∏—Å–ø—Ä—É–¥–µ–Ω—Ü–∏—è, –ø–µ–¥–∞–≥–æ–≥–∏–∫–∞",
          aliases: ["–∫–∞–∑–Ω—É", "farabi", "–∞–ª—å-—Ñ–∞—Ä–∞–±–∏", "–∫–∞–∑–∞—Ö—Å–∫–∏–π –Ω–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç"]
        },
        "abai": {
          name: "–ö–∞–∑–∞—Ö—Å–∫–∏–π –Ω–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–µ–¥–∞–≥–æ–≥–∏—á–µ—Å–∫–∏–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç –∏–º. –ê–±–∞—è (Abai University)",
          military: "–µ—Å—Ç—å (–æ—Ç–±–æ—Ä –Ω–∞ –∫–æ–Ω–∫—É—Ä—Å–Ω–æ–π –æ—Å–Ω–æ–≤–µ)",
          scores: "–¥–ª—è –ø–µ–¥–∞–≥–æ–≥–∏—á–µ—Å–∫–∏—Ö –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π —á–∞—Å—Ç–æ –≤—ã—à–µ (–æ—Ç ~70), –¥–ª—è –¥—Ä—É–≥–∏—Ö –æ—Ç ~65",
          budget: "–µ—Å—Ç—å –±—é–¥–∂–µ—Ç–Ω—ã–µ –º–µ—Å—Ç–∞, –ø—É–±–ª–∏–∫—É—é—Ç—Å—è –ø–æ –≥—Ä—É–ø–ø–∞–º –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º",
          directions: "–ø–µ–¥–∞–≥–æ–≥–∏–∫–∞, –¥–æ—à–∫–æ–ª—å–Ω–æ–µ –∏ —à–∫–æ–ª—å–Ω–æ–µ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ, –º–µ—Ç–æ–¥–∏–∫–∏ –ø—Ä–µ–ø–æ–¥–∞–≤–∞–Ω–∏—è, —Ñ–∏–∑–∫—É–ª—å—Ç—É—Ä–∞, –º—É–∑—ã–∫–∞, –∏—Å–∫—É—Å—Å—Ç–≤–æ",
          aliases: ["–∞–±–∞–π", "abai", "–∫–∞–∑–∞—Ö—Å–∫–∏–π –ø–µ–¥–∞–≥–æ–≥–∏—á–µ—Å–∫–∏–π", "–∫–∑–Ω–ø—É"]
        },
        "satbayev": {
          name: "Satbayev University (–°–∞—Ç–±–∞–µ–≤)",
          military: "–µ—Å—Ç—å (–ø—Ä–∏—ë–º –Ω–∞ –∫–∞—Ñ–µ–¥—Ä—É –ø—Ä–æ–≤–æ–¥–∏—Ç—Å—è –Ω–∞ –∫–æ–Ω–∫—É—Ä—Å–Ω–æ–π –æ—Å–Ω–æ–≤–µ)",
          scores: "–º–∏–Ω–∏–º—É–º –¥–ª—è –∫–æ–Ω–∫—É—Ä—Å–∞ –≥—Ä–∞–Ω—Ç–æ–≤ –æ—Ç 65 –±–∞–ª–ª–æ–≤",
          budget: "–µ—Å—Ç—å –±—é–¥–∂–µ—Ç–Ω—ã–µ –º–µ—Å—Ç–∞ –ø–æ –ø—Ä–æ–≥—Ä–∞–º–º–∞–º",
          directions: "–∏–Ω–∂–µ–Ω–µ—Ä–∏—è, IT, –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞, –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã, –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å, –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–µ –Ω–∞—É–∫–∏",
          aliases: ["—Å–∞—Ç–±–∞–µ–≤", "satbayev", "—Å–∞—Ç–ø–∞–µ–≤"]
        },
        "kaznmu": {
          name: "–ö–∞–∑–∞—Ö—Å–∫–∏–π –Ω–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç –∏–º. –°.–î. –ê—Å—Ñ–µ–Ω–¥–∏—è—Ä–æ–≤–∞ (KazNMU)",
          military: "–µ—Å—Ç—å (–ø—Ä–∞–≤–∏–ª–∞ –ø—Ä–∏—ë–º–∞ –Ω–∞ –≤–æ–µ–Ω–Ω—É—é –∫–∞—Ñ–µ–¥—Ä—É)",
          scores: "–≤—ã—Å–æ–∫–∏–µ –±–∞–ª–ª—ã (—á–∞—Å—Ç–æ >110 –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø—Ä–æ–≥—Ä–∞–º–º—ã)",
          budget: "–µ—Å—Ç—å –±—é–¥–∂–µ—Ç–Ω—ã–µ –º–µ—Å—Ç–∞ –ø–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—è–º",
          directions: "–º–µ–¥–∏—Ü–∏–Ω–∞ (–ª–µ—á–µ–±–Ω–æ–µ –¥–µ–ª–æ), –ø–µ–¥–∏–∞—Ç—Ä–∏—è, —Å—Ç–æ–º–∞—Ç–æ–ª–æ–≥–∏—è, —Ñ–∞—Ä–º–∞—Ü–∏—è, —Å–µ—Å—Ç—Ä–∏–Ω—Å–∫–æ–µ –¥–µ–ª–æ, –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –∑–¥–æ—Ä–æ–≤—å–µ",
          aliases: ["–∫–∞–∑–Ω–º—É", "–º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π", "–∞—Å—Ñ–µ–Ω–¥–∏—è—Ä–æ–≤"]
        },
        "abylai": {
          name: "–ö–∞–∑–∞—Ö—Å–∫–∏–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã—Ö –æ—Ç–Ω–æ—à–µ–Ω–∏–π –∏ –º–∏—Ä–æ–≤—ã—Ö —è–∑—ã–∫–æ–≤ –∏–º. –ê–±—ã–ª–∞–π —Ö–∞–Ω–∞ (KazUIR)",
          military: "–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–∞ –Ω–∞ —Å–∞–π—Ç–µ (—Å–º. —Ä–∞–∑–¥–µ–ª ¬´–ê–±–∏—Ç—É—Ä–∏–µ–Ω—Ç–∞–º¬ª)",
          scores: "—Ä–∞–∑–Ω—ã–µ –ø–æ –ø—Ä–æ–≥—Ä–∞–º–º–∞–º, –ø—É–±–ª–∏–∫—É—é—Ç—Å—è –Ω–∞ —Å–∞–π—Ç–µ",
          budget: "–µ—Å—Ç—å –±—é–¥–∂–µ—Ç–Ω—ã–µ –º–µ—Å—Ç–∞, –ø—É–±–ª–∏–∫—É—é—Ç—Å—è –µ–∂–µ–≥–æ–¥–Ω–æ",
          directions: "–º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è, –¥–∏–ø–ª–æ–º–∞—Ç–∏—è, –ª–∏–Ω–≥–≤–∏—Å—Ç–∏–∫–∞, —Ä–µ–≥–∏–æ–Ω–æ–≤–µ–¥–µ–Ω–∏–µ, –ø–µ—Ä–µ–≤–æ–¥, –ø–æ–ª–∏—Ç–æ–ª–æ–≥–∏—è",
          aliases: ["–∞–±—ã–ª–∞–π", "abylai", "–∫–∞–∑–∞—Ö—Å–∫–∏–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã—Ö –æ—Ç–Ω–æ—à–µ–Ω–∏–π"]
        },
        "kbtu": {
          name: "–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–æ-–ë—Ä–∏—Ç–∞–Ω—Å–∫–∏–π —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç (KBTU)",
          military: "–µ—Å—Ç—å (–Ω–∞–±–æ—Ä –Ω–∞ –≤–æ–µ–Ω–Ω—É—é –∫–∞—Ñ–µ–¥—Ä—É)",
          scores: "–≤—ã—Å–æ–∫–∏–π –∫–æ–Ω–∫—É—Ä—Å (100+ –∏–ª–∏ 110+ –¥–ª—è –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π)",
          budget: "–µ—Å—Ç—å –±—é–¥–∂–µ—Ç–Ω—ã–µ –º–µ—Å—Ç–∞ –ø–æ –ø—Ä–æ–≥—Ä–∞–º–º–∞–º",
          directions: "–∏–Ω–∂–µ–Ω–µ—Ä–∏—è, IT, –º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç –≤ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —Å—Ñ–µ—Ä–∞—Ö, —Ö–∏–º–∏–Ω–∂–∏–Ω–∏—Ä–∏–Ω–≥, –º–∞—Ç–µ—Ä–∏–∞–ª—ã, —ç–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞, —Ñ–∏–Ω–∞–Ω—Å—ã",
          aliases: ["–∫–±—Ç—É", "kbtu", "–±—Ä–∏—Ç–∞–Ω—Å–∫–∏–π —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π"]
        },
        "dku": {
          name: "–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–æ-–ù–µ–º–µ—Ü–∫–∏–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç (DKU)",
          military: "–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –Ω–∞ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–º —Å–∞–π—Ç–µ",
          scores: "–ø–æ—Ä–æ–≥–∏ –∑–∞–≤–∏—Å—è—Ç –æ—Ç –≥—Ä—É–ø–ø—ã –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º",
          budget: "–µ—Å—Ç—å –≥—Ä–∞–Ω—Ç—ã –∏ –∫–≤–æ—Ç—ã (—á–∞—Å—Ç–Ω—ã–π/–º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–π –≤—É–∑)",
          directions: "–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç, –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω–æ–µ —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–æ, –∏–Ω–∂–µ–Ω–µ—Ä–Ω—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã —Å –Ω–µ–º–µ—Ü–∫–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–π, —è–∑—ã–∫–∏, –±–∏–∑–Ω–µ—Å-–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ",
          aliases: ["–¥–∫—É", "dku", "–Ω–µ–º–µ—Ü–∫–∏–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç"]
        },
        "krmu": {
          name: "–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–æ-–†–æ—Å—Å–∏–π—Å–∫–∏–π –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç (–ö–†–ú–£)",
          military: "–µ—Å—Ç—å (–æ—Ç–±–æ—Ä –Ω–∞ –≤–æ–µ–Ω–Ω—É—é –∫–∞—Ñ–µ–¥—Ä—É)",
          scores: "–≤—ã—Å–æ–∫–∏–µ –±–∞–ª–ª—ã (–æ—Ç 70 –∏ –≤—ã—à–µ –¥–ª—è —É—á–∞—Å—Ç–∏—è –≤ –∫–æ–Ω–∫—É—Ä—Å–µ)",
          budget: "–µ—Å—Ç—å –±—é–¥–∂–µ—Ç–Ω—ã–µ –º–µ—Å—Ç–∞ –ø–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—è–º",
          directions: "–ª–µ—á–µ–±–Ω–æ–µ –¥–µ–ª–æ, –∑—É–±–æ–≤—Ä–∞—á–µ–±–Ω–æ–µ –¥–µ–ª–æ, —Å–µ—Å—Ç—Ä–∏–Ω—Å–∫–æ–µ –¥–µ–ª–æ, –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –∑–¥–æ—Ä–æ–≤—å–µ",
          aliases: ["–∫—Ä–º—É", "krmu", "—Ä–æ—Å—Å–∏–π—Å–∫–∏–π –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π"]
        },
        "atu": {
          name: "–ê–ª–º–∞—Ç–∏–Ω—Å–∫–∏–π —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç (–ê–¢–£)",
          military: "–µ—Å—Ç—å (–Ω–∞–±–æ—Ä –Ω–∞ –≤–æ–µ–Ω–Ω—É—é –ø–æ–¥–≥–æ—Ç–æ–≤–∫—É)",
          scores: "–ø–æ—Ä–æ–≥–∏ –ø–æ –ø—Ä–æ–≥—Ä–∞–º–º–∞–º (–æ—Ç ~45‚Äì65 –∏ –≤—ã—à–µ)",
          budget: "–µ—Å—Ç—å –±—é–¥–∂–µ—Ç–Ω—ã–µ –º–µ—Å—Ç–∞",
          directions: "–ø–∏—â–µ–≤–∞—è –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç—å, —Ç–µ–∫—Å—Ç–∏–ª—å, —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏, –∏–Ω–∂–µ–Ω–µ—Ä–Ω—ã–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏, IT, —ç–∫–æ–Ω–æ–º–∏–∫–∞, —Ç—É—Ä–∏–∑–º –∏ —Å–µ—Ä–≤–∏—Å",
          aliases: ["–∞—Ç—É", "atu", "–∞–ª–º–∞—Ç–∏–Ω—Å–∫–∏–π —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π"]
        },
        "aues": {
          name: "–ê–ª–º–∞—Ç–∏–Ω—Å–∫–∏–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç —ç–Ω–µ—Ä–≥–µ—Ç–∏–∫–∏ –∏ —Å–≤—è–∑–∏ (AUES)",
          military: "–µ—Å—Ç—å (–ø—É–±–ª–∏–∫—É—é—Ç—Å—è –æ–±—ä—è–≤–ª–µ–Ω–∏—è –æ –Ω–∞–±–æ—Ä–µ)",
          scores: "–µ—Å—Ç—å –ø—Ä–æ—Ö–æ–¥–Ω—ã–µ –±–∞–ª–ª—ã –ø–æ –ø—Ä–æ–≥—Ä–∞–º–º–∞–º",
          budget: "–µ—Å—Ç—å –±—é–¥–∂–µ—Ç–Ω—ã–µ –º–µ—Å—Ç–∞",
          directions: "—ç–Ω–µ—Ä–≥–µ—Ç–∏–∫–∞, —ç–ª–µ–∫—Ç—Ä–æ—Ç–µ—Ö–Ω–∏–∫–∞, –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏, –òT, —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏",
          aliases: ["–∞—É—ç—Å", "aues", "—ç–Ω–µ—Ä–≥–µ—Ç–∏–∫–∏ –∏ —Å–≤—è–∑–∏", "–¥–∞—É–∫–µ–µ–≤"]
        },
        "ageu": {
          name: "–ê–ª–º–∞—Ç–∏–Ω—Å–∫–∏–π –≥—É–º–∞–Ω–∏—Ç–∞—Ä–Ω–æ-—ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç (–ê–ì–≠–£)",
          military: "–µ—Å—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤–æ–µ–Ω–Ω–æ–π –∫–∞—Ñ–µ–¥—Ä–µ",
          scores: "–ø–æ—Ä–æ–≥–æ–≤—ã–µ –±–∞–ª–ª—ã –ø–æ –ø—Ä–æ–≥—Ä–∞–º–º–∞–º –ø—É–±–ª–∏–∫—É—é—Ç—Å—è",
          budget: "–µ—Å—Ç—å –≥—Ä–∞–Ω—Ç—ã/–±—é–¥–∂–µ—Ç–Ω—ã–µ –º–µ—Å—Ç–∞",
          directions: "—ç–∫–æ–Ω–æ–º–∏–∫–∞, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞, –º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç, –ø—Ä–∞–≤–æ, –±—É—Ö–≥–∞–ª—Ç–µ—Ä–∏—è, IT, –º–µ–¥–∏–∞/–¥–∏–∑–∞–π–Ω",
          aliases: ["–∞–≥–µ—É", "ageu", "–≥—É–º–∞–Ω–∏—Ç–∞—Ä–Ω–æ-—ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π"]
        },
        "alma": {
          name: "–ê–ª–º–∞—Ç—ã –ú–µ–Ω–µ–¥–∂–º–µ–Ω—Ç –£–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç (AlmaU)",
          military: "–Ω–µ—Ç (–±–∏–∑–Ω–µ—Å/–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç –≤—É–∑)",
          scores: "–ø—Ä–æ—Ö–æ–¥–Ω–æ–π –±–∞–ª–ª –ø—Ä–∏–º–µ—Ä–Ω–æ 75‚Äì101 –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø—Ä–æ–≥—Ä–∞–º–º—ã",
          budget: "–µ—Å—Ç—å –≥—Ä–∞–Ω—Ç—ã/–∫–≤–æ—Ç—ã –Ω–∞ –±–∞–∫–∞–ª–∞–≤—Ä–∏–∞—Ç –∏ –º–∞–≥–∏—Å—Ç—Ä–∞—Ç—É—Ä—É",
          directions: "–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç, —Ñ–∏–Ω–∞–Ω—Å—ã, –º–∞—Ä–∫–µ—Ç–∏–Ω–≥, –ø—Ä–∞–≤–æ, –±–∏–∑–Ω–µ—Å-–∞–Ω–∞–ª–∏—Ç–∏–∫–∞, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ–ª–æ–≤–µ—á–µ—Å–∫–∏–º–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏, –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã",
          aliases: ["–∞–ª–º–∞—É", "almau", "–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç"]
        }
      };

      // –†–ê–°–®–ò–†–ï–ù–ù–´–ô FAQ –î–õ–Ø –ü–†–û–§–û–†–ò–ï–ù–¢–ê–¶–ò–ò
      const faq = [
        {
          keywords: ['–ø—Ä–æ—Ñ–µ—Å—Å–∏—è', '–ø—Ä–æ—Ñ–µ—Å—Å–∏–∏', '–∫–µ–º —Å—Ç–∞—Ç—å', '–≤—ã–±–æ—Ä –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏', '–∫–∞—Ä—å–µ—Ä–∞', '–ø—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è', '–±—É–¥—É—â–∞—è –ø—Ä–æ—Ñ–µ—Å—Å–∏—è', '—Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å', '–ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –≤—ã–±–æ—Ä', '–∫–µ–º —Ä–∞–±–æ—Ç–∞—Ç—å', '–∫–∞–∫—É—é –ø—Ä–æ—Ñ–µ—Å—Å–∏—é –≤—ã–±—Ä–∞—Ç—å', '–ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Å–∞–º–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ', '–≤—ã–±—Ä–∞—Ç—å –ø—Ä–æ—Ñ–µ—Å—Å–∏—é', '–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å—Å—è —Å –ø—Ä–æ—Ñ–µ—Å—Å–∏–µ–π', '–±—É–¥—É—â–∞—è —Ä–∞–±–æ—Ç–∞', '–∫–∞—Ä—å–µ—Ä–Ω—ã–π –ø—É—Ç—å', '–ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å'],
          answer: '–ù–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ NeXus –≤—ã –º–æ–∂–µ—Ç–µ –ø—Ä–æ–π—Ç–∏ –ø—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–º–æ–≥—É—Ç –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–æ–¥—Ö–æ–¥—è—â–∏–µ –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–∞—à–∏—Ö –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤, —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π –∏ –æ—Ü–µ–Ω–æ–∫. –ú—ã –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –≤–∞—à–∏ —Å–∫–ª–æ–Ω–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –≤–∞–º –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã –∏ –≤–æ—Å—Ç—Ä–µ–±–æ–≤–∞–Ω—ã –Ω–∞ —Ä—ã–Ω–∫–µ —Ç—Ä—É–¥–∞.'
        },
        {
          keywords: ['—Ç–µ—Å—Ç', '—Ç–µ—Å—Ç—ã', '–ø—Ä–æ—Ñ—Ç–µ—Å—Ç', '–ø—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–æ–Ω–Ω—ã–π', '–ø—Ä–æ–π—Ç–∏ —Ç–µ—Å—Ç', '–æ–ø—Ä–æ—Å', '–∞–Ω–∫–µ—Ç–∞', '–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞', '—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ', '–ø—Ä–æ–π—Ç–∏ –æ–ø—Ä–æ—Å', '–ø—Ä–æ–π—Ç–∏ –∞–Ω–∫–µ—Ç—É', '–ø—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–æ–Ω–Ω—ã–π —Ç–µ—Å—Ç', '—Ç–µ—Å—Ç –Ω–∞ –ø—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—é', '—Ç–µ—Å—Ç –Ω–∞ –ø—Ä–æ—Ñ–µ—Å—Å–∏—é', '–ø—Ä–æ–π—Ç–∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É', '—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π', '–æ–ø—Ä–æ—Å–Ω–∏–∫', '–ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Ç–µ—Å—Ç'],
          answer: '–í —Ä–∞–∑–¥–µ–ª–µ "–¢–µ—Å—Ç—ã" –¥–æ—Å—Ç—É–ø–Ω—ã —Ä–∞–∑–ª–∏—á–Ω—ã–µ –ø—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã. –ü–æ—Å–ª–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –≤—ã –ø–æ–ª—É—á–∏—Ç–µ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ø—Ä–æ—Ñ–µ—Å—Å–∏—è–º –∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º –æ–±—É—á–µ–Ω–∏—è. –•–æ—Ç–∏—Ç–µ –ø—Ä–æ–π—Ç–∏ –±—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å? –ù–∞–ø–∏—à–∏—Ç–µ "–ø—Ä–æ–π—Ç–∏ —Ç–µ—Å—Ç" –∏–ª–∏ "–Ω–∞—á–∞—Ç—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ".'
        },
        {
          keywords: ['–ø—Ä–æ–π—Ç–∏ —Ç–µ—Å—Ç', '–Ω–∞—á–∞—Ç—å —Ç–µ—Å—Ç', '–Ω–∞—á–∞—Ç—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ', '–ø—Ä–æ–π—Ç–∏ –æ–ø—Ä–æ—Å', '–∑–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç', '–Ω–∞—á–∞—Ç—å –ø—Ä–æ—Ñ—Ç–µ—Å—Ç', '–ø—Ä–æ–π—Ç–∏ –ø—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—é', '–Ω–∞—á–∞—Ç—å –ø—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—é', '—Ö–æ—á—É —Ç–µ—Å—Ç', '–º–æ–∂–Ω–æ —Ç–µ—Å—Ç', '–¥–∞–≤–∞–π —Ç–µ—Å—Ç', '–ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π –º–µ–Ω—è', '–ø—Ä–æ–≤–µ–¥–∏ —Ç–µ—Å—Ç', '—Å–¥–µ–ª–∞—Ç—å —Ç–µ—Å—Ç', '–ø—Ä–æ–π—Ç–∏ –ø—Ä–æ–≤–µ—Ä–∫—É', '—Ç–µ—Å—Ç–∏—Ä—É–π'],
          answer: 'test' // –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –º–∞—Ä–∫–µ—Ä –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–∞
        },
        {
          keywords: ['–≤–æ–µ–Ω–Ω–∞—è –∫–∞—Ñ–µ–¥—Ä–∞', '–≤–æ–µ–Ω–∫–∞', '–∞—Ä–º–∏—è', '–≤–æ–µ–Ω–Ω–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞', '–≤–æ–µ–Ω–Ω–æ–µ –¥–µ–ª–æ', '–≤–æ–µ–Ω–Ω—É—é', '–∫–∞—Ñ–µ–¥—Ä–∞', '–≤–æ–µ–Ω–Ω—É—é –ø–æ–¥–≥–æ—Ç–æ–≤–∫—É', '—Å–ª—É–∂–±–∞', '–æ—Ç—Å—Ä–æ—á–∫–∞'],
          answer: 'military' // –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –º–∞—Ä–∫–µ—Ä –¥–ª—è –≤–æ–ø—Ä–æ—Å–∞ –æ –≤–æ–µ–Ω–Ω–æ–π –∫–∞—Ñ–µ–¥—Ä–µ
        },
        {
          keywords: ['–±–∞–ª–ª—ã', '–ø—Ä–æ—Ö–æ–¥–Ω–æ–π –±–∞–ª–ª', '–µ–Ω—Ç', '—ç–∫–∑–∞–º–µ–Ω', '—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã', '–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –±–∞–ª–ª', '–≤—Å—Ç—É–ø–∏—Ç–µ–ª—å–Ω—ã–µ', '–±–∞–ª–ª—ã –µ–Ω—Ç', '—Å—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª', '–ø—Ä–æ—Ö–æ–¥–Ω—ã–µ –±–∞–ª–ª—ã', '–±–∞–ª–ª—ã –¥–ª—è –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è', '–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –±–∞–ª–ª—ã', '—Ç—Ä–µ–±—É–µ–º—ã–µ –±–∞–ª–ª—ã', '—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —ç–∫–∑–∞–º–µ–Ω–æ–≤', '–≤—Å—Ç—É–ø–∏—Ç–µ–ª—å–Ω—ã–µ –∏—Å–ø—ã—Ç–∞–Ω–∏—è', '—ç–∫–∑–∞–º–µ–Ω–∞—Ü–∏–æ–Ω–Ω—ã–µ –±–∞–ª–ª—ã', '–ø–æ—Ä–æ–≥–æ–≤—ã–π'],
          answer: 'scores' // –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –º–∞—Ä–∫–µ—Ä –¥–ª—è –≤–æ–ø—Ä–æ—Å–∞ –æ –±–∞–ª–ª–∞—Ö
        },
        {
          keywords: ['–±—é–¥–∂–µ—Ç', '–≥—Ä–∞–Ω—Ç', '—Å—Ç–∏–ø–µ–Ω–¥–∏—è', '–±—é–¥–∂–µ—Ç–Ω–æ–µ', '–±–µ—Å–ø–ª–∞—Ç–Ω–æ–µ', '–æ–±—É—á–µ–Ω–∏–µ', '—Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏–µ', '—Å—Ç–æ–∏–º–æ—Å—Ç—å', '—Ü–µ–Ω–∞', '–±—é–¥–∂–µ—Ç–Ω–æ–µ –º–µ—Å—Ç–æ', '–∫–æ–Ω—Ç—Ä–∞–∫—Ç', '–æ–ø–ª–∞—Ç–∞ –æ–±—É—á–µ–Ω–∏—è', '—Å—Ç–æ–∏–º–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è', '–±–µ—Å–ø–ª–∞—Ç–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ', '–≥—Ä–∞–Ω—Ç—ã –Ω–∞ –æ–±—É—á–µ–Ω–∏–µ', '–æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –≥—Ä–∞–Ω—Ç—ã', '—Å—Ç–∏–ø–µ–Ω–¥–∏–∏ –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–æ–≤', '—Ñ–∏–Ω–∞–Ω—Å–æ–≤–∞—è –ø–æ–º–æ—â—å'],
          answer: 'budget' // –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –º–∞—Ä–∫–µ—Ä –¥–ª—è –≤–æ–ø—Ä–æ—Å–∞ –æ –±—é–¥–∂–µ—Ç–µ
        },
        {
          keywords: ['–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è', '—Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏', '—Ñ–∞–∫—É–ª—å—Ç–µ—Ç—ã', '–ø—Ä–æ–≥—Ä–∞–º–º—ã', '–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ', '–æ–±—É—á–µ–Ω–∏–µ', '—á—Ç–æ –∏–∑—É—á–∞—Ç—å', '–∫–∞–∫–∏–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è', '—Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å', '—Ñ–∞–∫—É–ª—å—Ç–µ—Ç', '–æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞'],
          answer: 'directions' // –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –º–∞—Ä–∫–µ—Ä –¥–ª—è –≤–æ–ø—Ä–æ—Å–∞ –æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è—Ö
        },
        {
          keywords: ['—É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç', '–≤—É–∑', '–∏–Ω—Å—Ç–∏—Ç—É—Ç', '–ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏–µ', '–≤—ã—Å—à–µ–µ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ', '—Ñ–∞–∫—É–ª—å—Ç–µ—Ç', '–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ', '—Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å –≤—É–∑–∞', '–≤—ã—Å—à–µ–µ —É—á–µ–±–Ω–æ–µ –∑–∞–≤–µ–¥–µ–Ω–∏–µ', '–ø–æ—Å—Ç—É–ø–∏—Ç—å –≤ –≤—É–∑', '–≤—ã–±—Ä–∞—Ç—å –≤—É–∑', '–ø–æ–¥–æ–±—Ä–∞—Ç—å —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç', '–∫—É–¥–∞ –ø–æ—Å—Ç—É–ø–∏—Ç—å', '–≤—ã–±–æ—Ä —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–∞', '—Ä–µ–π—Ç–∏–Ω–≥ –≤—É–∑–æ–≤', '—Ç–æ–ø —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–æ–≤', '–ª—É—á—à–∏–µ –≤—É–∑—ã', '–≤—É–∑—ã —Ä–æ—Å—Å–∏–∏', '—É–Ω–∏–≤–µ—Ä'],
          answer: 'university' // –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –º–∞—Ä–∫–µ—Ä –¥–ª—è –æ–±—â–µ–≥–æ –≤–æ–ø—Ä–æ—Å–∞ –æ–± —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–∞—Ö
        },
        // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ FAQ –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
      ];

      const defaultReply = '–ù–µ —Å–æ–≤—Å–µ–º –ø–æ–Ω—è–ª –≤–∞—à –≤–æ–ø—Ä–æ—Å –æ –ø—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏ –∏–ª–∏ –≤—ã–±–æ—Ä–µ –≤—É–∑–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–µ—Ä–µ—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –∏–ª–∏ –Ω–∞–ø–∏—à–∏—Ç–µ "–ü–æ–∑–≤–∞—Ç—å –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç–∞" –¥–ª—è —Å–≤—è–∑–∏ —Å–æ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–º. –ú–æ–∂–µ—Ç–µ —Ç–∞–∫–∂–µ —Ä–∞—Å—Å–∫–∞–∑–∞—Ç—å –æ —Å–≤–æ–∏—Ö –∏–Ω—Ç–µ—Ä–µ—Å–∞—Ö - —è –ø–æ–º–æ–≥—É –ø–æ–¥–æ–±—Ä–∞—Ç—å –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏!';

      // –î–ê–ù–ù–´–ï –î–õ–Ø –ü–†–û–§–û–†–ò–ï–ù–¢–ê–¶–ò–û–ù–ù–û–ì–û –¢–ï–°–¢–ê
      const proforientationTest = [
        {
          question: "–ö–∞–∫–æ–π —Ç–∏–ø –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤–∞–º –±–æ–ª—å—à–µ –Ω—Ä–∞–≤–∏—Ç—Å—è?",
          options: [
            "–†–∞–±–æ—Ç–∞ —Å –ª—é–¥—å–º–∏ (–æ–±—â–µ–Ω–∏–µ, –ø–æ–º–æ—â—å, –æ–±—É—á–µ–Ω–∏–µ)",
            "–†–∞–±–æ—Ç–∞ —Å —Ç–µ—Ö–Ω–∏–∫–æ–π –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è–º–∏",
            "–¢–≤–æ—Ä—á–µ—Å–∫–∞—è —Ä–∞–±–æ—Ç–∞ (–∏—Å–∫—É—Å—Å—Ç–≤–æ, –¥–∏–∑–∞–π–Ω, –º—É–∑—ã–∫–∞)",
            "–ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞–±–æ—Ç–∞ (–∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è, –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö)",
            "–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–æ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞ (—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ, –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ)"
          ]
        },
        {
          question: "–ß—Ç–æ –≤–∞–º –∏–Ω—Ç–µ—Ä–µ—Å–Ω–µ–µ –≤—Å–µ–≥–æ?",
          options: [
            "–ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –Ω–∞—É–∫–∏ (–±–∏–æ–ª–æ–≥–∏—è, —Ö–∏–º–∏—è, –º–µ–¥–∏—Ü–∏–Ω–∞)",
            "–¢–µ—Ö–Ω–∏–∫–∞ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏",
            "–ò—Å–∫—É—Å—Å—Ç–≤–æ –∏ –∫—É–ª—å—Ç—É—Ä–∞",
            "–û–±—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –Ω–∞—É–∫–∏ –∏ –ø—Ä–∞–≤–æ",
            "–ë–∏–∑–Ω–µ—Å –∏ —ç–∫–æ–Ω–æ–º–∏–∫–∞"
          ]
        },
        {
          question: "–ö–∞–∫ –≤—ã –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ—Ç–µ —Ä–∞–±–æ—Ç–∞—Ç—å?",
          options: [
            "–í –∫–æ–º–∞–Ω–¥–µ, –æ–±—â–∞—è—Å—å —Å –∫–æ–ª–ª–µ–≥–∞–º–∏",
            "–°–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ, —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–µ–Ω–Ω–æ",
            "–¢–≤–æ—Ä—á–µ—Å–∫–∏, –≤—ã—Ä–∞–∂–∞—è —Å–≤–æ–∏ –∏–¥–µ–∏",
            "–ê–Ω–∞–ª–∏–∑–∏—Ä—É—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏ –¥–∞–Ω–Ω—ã–µ",
            "–û—Ä–≥–∞–Ω–∏–∑—É—è –ø—Ä–æ—Ü–µ—Å—Å—ã –∏ –ª—é–¥–µ–π"
          ]
        },
        {
          question: "–ß—Ç–æ –¥–ª—è –≤–∞—Å –≤–∞–∂–Ω–µ–µ –≤ —Ä–∞–±–æ—Ç–µ?",
          options: [
            "–ü–æ–º–æ—â—å –¥—Ä—É–≥–∏–º –ª—é–¥—è–º",
            "–°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —Ä–µ—à–µ–Ω–∏–π",
            "–°–∞–º–æ–≤—ã—Ä–∞–∂–µ–Ω–∏–µ –∏ –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å",
            "–ü–æ–∏—Å–∫ –∏—Å—Ç–∏–Ω—ã –∏ –∞–Ω–∞–ª–∏–∑",
            "–î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∏ —É—Å–ø–µ—Ö–∞"
          ]
        },
        {
          question: "–ö–∞–∫–æ–π —à–∫–æ–ª—å–Ω—ã–π –ø—Ä–µ–¥–º–µ—Ç –≤–∞–º –Ω—Ä–∞–≤–∏—Ç—Å—è –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ?",
          options: [
            "–ë–∏–æ–ª–æ–≥–∏—è, —Ö–∏–º–∏—è, –≥–µ–æ–≥—Ä–∞—Ñ–∏—è",
            "–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞, —Ñ–∏–∑–∏–∫–∞, –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞",
            "–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞, –∏—Å–∫—É—Å—Å—Ç–≤–æ, –º—É–∑—ã–∫–∞",
            "–ò—Å—Ç–æ—Ä–∏—è, –æ–±—â–µ—Å—Ç–≤–æ–∑–Ω–∞–Ω–∏–µ, –ø—Ä–∞–≤–æ",
            "–≠–∫–æ–Ω–æ–º–∏–∫–∞, –±–∏–∑–Ω–µ—Å-–ø—Ä–µ–¥–º–µ—Ç—ã"
          ]
        }
      ];

      const testResults = {
        "–ß–µ–ª–æ–≤–µ–∫–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏": ["–ü—Å–∏—Ö–æ–ª–æ–≥", "–£—á–∏—Ç–µ–ª—å", "–í—Ä–∞—á", "–°–æ—Ü–∏–∞–ª—å–Ω—ã–π —Ä–∞–±–æ—Ç–Ω–∏–∫", "HR-—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç"],
        "–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏": ["–ò–Ω–∂–µ–Ω–µ—Ä", "–ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç", "–ê–Ω–∞–ª–∏—Ç–∏–∫ –¥–∞–Ω–Ω—ã—Ö", "–°–µ—Ç–µ–≤–æ–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä", "–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç"],
        "–¢–≤–æ—Ä—á–µ—Å–∫–∏–µ –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏": ["–î–∏–∑–∞–π–Ω–µ—Ä", "–•—É–¥–æ–∂–Ω–∏–∫", "–ú—É–∑—ã–∫–∞–Ω—Ç", "–ê—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä", "–ö–æ–ø–∏—Ä–∞–π—Ç–µ—Ä"],
        "–ù–∞—É—á–Ω–æ-–∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏": ["–£—á–µ–Ω—ã–π", "–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å", "–ê–Ω–∞–ª–∏—Ç–∏–∫", "–≠–∫—Å–ø–µ—Ä—Ç", "–ö–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç"],
        "–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏": ["–ú–µ–Ω–µ–¥–∂–µ—Ä", "–ü—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å", "–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å", "–û—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä", "–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä"]
      };

      let currentTestState = {
        inProgress: false,
        currentQuestion: 0,
        answers: [],
        userInterests: []
      };

      let currentUniversityContext = null;

      function findUniversityByName(name) {
        const lowerName = name.toLowerCase();
        for (const [key, uni] of Object.entries(universities)) {
          if (uni.aliases.some(alias => lowerName.includes(alias)) || 
              lowerName.includes(key) ||
              lowerName.includes(uni.name.toLowerCase())) {
            return key;
          }
        }
        return null;
      }

      function getUniversityInfo(universityKey, infoType) {
        const uni = universities[universityKey];
        if (!uni) return null;

        switch(infoType) {
          case 'military':
            return `üéñÔ∏è ${uni.name}\n\n–í–æ–µ–Ω–Ω–∞—è –∫–∞—Ñ–µ–¥—Ä–∞: ${uni.military}`;
          case 'scores':
            return `üìä ${uni.name}\n\n–ü–æ—Ä–æ–≥–æ–≤—ã–µ –±–∞–ª–ª—ã –ï–ù–¢: ${uni.scores}`;
          case 'budget':
            return `üí∞ ${uni.name}\n\n–ë—é–¥–∂–µ—Ç–Ω—ã–µ –º–µ—Å—Ç–∞: ${uni.budget}`;
          case 'directions':
            return `üéØ ${uni.name}\n\n–û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è: ${uni.directions}`;
          case 'all':
            return `üè´ ${uni.name}\n\nüéñÔ∏è –í–æ–µ–Ω–Ω–∞—è –∫–∞—Ñ–µ–¥—Ä–∞: ${uni.military}\nüìä –ë–∞–ª–ª—ã –ï–ù–¢: ${uni.scores}\nüí∞ –ë—é–¥–∂–µ—Ç: ${uni.budget}\nüéØ –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è: ${uni.directions}`;
          default:
            return `üè´ ${uni.name}\n\n${uni.directions}`;
        }
      }

      function showUniversityButtons(messageType) {
        const buttonsMessage = document.createElement('div');
        buttonsMessage.className = 'message bot-message animate-fade-in';
        
        let html = `<div class="test-question">
          <strong>–í—ã–±–µ—Ä–∏—Ç–µ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏:</strong><br><br>
          <div style="display: flex; flex-wrap: wrap; gap: 5px;">`;
        
        Object.entries(universities).forEach(([key, uni]) => {
          const shortName = uni.name.split('(')[0].trim();
          html += `<button class="university-button" onclick="handleUniversitySelect('${key}', '${messageType}')">${shortName}</button>`;
        });
        
        html += `</div></div>`;
        buttonsMessage.innerHTML = html;
        chatContainer.appendChild(buttonsMessage);
        chatContainer.scrollTo({ top: chatContainer.scrollHeight, behavior: 'smooth' });
      }

      function handleUniversitySelect(universityKey, infoType) {
        const info = getUniversityInfo(universityKey, infoType);
        if (info) {
          const infoMessage = document.createElement('div');
          infoMessage.className = 'message bot-message animate-fade-in';
          infoMessage.textContent = info;
          chatContainer.appendChild(infoMessage);
          chatContainer.scrollTo({ top: chatContainer.scrollHeight, behavior: 'smooth' });
        }
      }

      function findAnswer(message) {
        const words = message
          .toLowerCase()
          .split(/[^a-z–∞-—è—ë0-9—ë]+/i)
          .filter(w => w && !stopWords.includes(w));
        let best = { answer: defaultReply, score: 0 };
        
        faq.forEach(item => {
          const score = item.keywords.reduce(
            (sum, kw) => words.includes(kw) ? sum + 1 : sum,
            0
          );
          if (score > best.score) best = { answer: item.answer, score };
        });

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∑–∞–ø—Ä–æ—Å —Ç–µ—Å—Ç–∞
        if (best.answer === 'test' || words.some(w => ['—Ç–µ—Å—Ç', '–ø—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è', '–æ–ø—Ä–æ—Å'].includes(w))) {
          startProforientationTest();
          return '';
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –æ–± —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–∞—Ö
        if (best.answer === 'military' || best.answer === 'scores' || best.answer === 'budget' || best.answer === 'directions') {
          // –°–Ω–∞—á–∞–ª–∞ –∏—â–µ–º —É–ø–æ–º–∏–Ω–∞–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–∞
          const foundUni = findUniversityByName(message);
          if (foundUni) {
            return getUniversityInfo(foundUni, best.answer);
          } else {
            showUniversityButtons(best.answer);
            return '';
          }
        }

        // –û–±—â–∏–π –≤–æ–ø—Ä–æ—Å –æ–± —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–∞—Ö
        if (best.answer === 'university') {
          const foundUni = findUniversityByName(message);
          if (foundUni) {
            return getUniversityInfo(foundUni, 'all');
          } else {
            showUniversityButtons('all');
            return '';
          }
        }

        return best.answer;
      }

      function startProforientationTest() {
        currentTestState = {
          inProgress: true,
          currentQuestion: 0,
          answers: [],
          userInterests: []
        };
        showTestQuestion(0);
      }

      function showTestQuestion(questionIndex) {
        const question = proforientationTest[questionIndex];
        const testMessage = document.createElement('div');
        testMessage.className = 'message bot-message animate-fade-in';
        
        let html = `<div class="test-question">
          <strong>–í–æ–ø—Ä–æ—Å ${questionIndex + 1}/${proforientationTest.length}</strong><br>
          ${question.question}
          <div style="margin-top: 10px;">`;
        
        question.options.forEach((option, index) => {
          html += `<button class="test-option" onclick="handleTestAnswer(${questionIndex}, ${index})">${option}</button>`;
        });
        
        html += `</div></div>`;
        testMessage.innerHTML = html;
        chatContainer.appendChild(testMessage);
        chatContainer.scrollTo({ top: chatContainer.scrollHeight, behavior: 'smooth' });
      }

      function handleTestAnswer(questionIndex, answerIndex) {
        currentTestState.answers[questionIndex] = answerIndex;
        currentTestState.currentQuestion++;
        
        if (currentTestState.currentQuestion < proforientationTest.length) {
          showTestQuestion(currentTestState.currentQuestion);
        } else {
          finishTest();
        }
      }

      function finishTest() {
        const result = calculateTestResult();
        const resultMessage = document.createElement('div');
        resultMessage.className = 'message bot-message animate-fade-in';
        
        let html = `<div class="test-question">
          <strong>üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤–∞—à–µ–≥–æ —Ç–µ—Å—Ç–∞!</strong><br><br>
          <strong>–í–∞–º –ø–æ–¥—Ö–æ–¥—è—Ç –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏ —Ç–∏–ø–∞: ${result.type}</strong><br><br>
          <strong>–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏:</strong><br>
          ${result.professions.join(', ')}<br><br>
          <strong>–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:</strong><br>
          1. –ò–∑—É—á–∏—Ç–µ –ø–æ–¥—Ä–æ–±–Ω–µ–µ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏<br>
          2. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–µ –≤—É–∑—ã –≤ –Ω–∞—à–µ–º –∫–∞—Ç–∞–ª–æ–≥–µ<br>
          3. –ü—Ä–æ–π–¥–∏—Ç–µ —É–≥–ª—É–±–ª–µ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ<br><br>
          –•–æ—Ç–∏—Ç–µ –ø–æ–ª—É—á–∏—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –≤—É–∑–∞–º?
        </div>`;
        
        resultMessage.innerHTML = html;
        chatContainer.appendChild(resultMessage);
        
        currentTestState.inProgress = false;
        chatContainer.scrollTo({ top: chatContainer.scrollHeight, behavior: 'smooth' });
      }

      function calculateTestResult() {
        const answerCounts = [0, 0, 0, 0, 0];
        currentTestState.answers.forEach(answer => {
          if (answer >= 0 && answer < answerCounts.length) {
            answerCounts[answer]++;
          }
        });
        
        const maxIndex = answerCounts.indexOf(Math.max(...answerCounts));
        const types = ["–ß–µ–ª–æ–≤–µ–∫–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏", "–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏", "–¢–≤–æ—Ä—á–µ—Å–∫–∏–µ –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏", "–ù–∞—É—á–Ω–æ-–∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏", "–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏"];
        
        return {
          type: types[maxIndex],
          professions: testResults[types[maxIndex]]
        };
      }

      // –î–µ–ª–∞–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ –≥–ª–æ–±–∞–ª—å–Ω—ã–º–∏ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–ª–∏–∫–æ–≤
      window.handleTestAnswer = handleTestAnswer;
      window.handleUniversitySelect = handleUniversitySelect;

      let pendingMedia = [];

      function clearMediaPreview() {
        pendingMedia = [];
        mediaPreview.innerHTML = '';
        mediaPreview.classList.add('hidden');
        cancelMediaButton.classList.add('hidden');
      }

      function updateMediaPreview() {
        mediaPreview.innerHTML = '';
        pendingMedia.forEach((media, index) => {
          const div = document.createElement('div');
          div.className = 'media-preview-item';
          div.innerHTML = `
            <img src="${media}" alt="Preview">
            <button data-index="${index}" type="button"><i class="fas fa-times"></i></button>
          `;
          mediaPreview.appendChild(div);
          div.querySelector('button').addEventListener('click', () => {
            pendingMedia.splice(index, 1);
            updateMediaPreview();
          });
        });
        mediaPreview.classList.toggle('hidden', pendingMedia.length === 0);
        cancelMediaButton.classList.toggle('hidden', pendingMedia.length === 0);
      }

      function handleFileInput(e) {
        const files = e.target.files;
        if (files.length) {
          Array.from(files).forEach(file => {
            if (!file.type.startsWith('image/')) {
              alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ');
              return;
            }
            const reader = new FileReader();
            reader.onload = (event) => {
              pendingMedia.push(event.target.result);
              updateMediaPreview();
            };
            reader.readAsDataURL(file);
          });
          e.target.value = '';
        }
      }

      function createNewChat() {
        // –û—á–∏—â–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —á–∞—Ç–∞
        chatContainer.innerHTML = '';
        
        // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ç–µ—Å—Ç–∞
        currentTestState = {
          inProgress: false,
          currentQuestion: 0,
          answers: [],
          userInterests: []
        };
        
        // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–∞
        currentUniversityContext = null;
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
        const welcomeMsg = document.createElement('div');
        welcomeMsg.className = 'message bot-message animate-fade-in';
        welcomeMsg.textContent = '–ü—Ä–∏–≤–µ—Ç! –Ø –ò–ò-–∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç NeXus. –ü–æ–º–æ–≥—É —Å –≤—ã–±–æ—Ä–æ–º –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏, –ø–æ–¥–±–æ—Ä–æ–º –≤—É–∑–∞ –∏ –ø—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–µ–π. –ú–æ–∂–µ—Ç–µ –ø—Ä–æ–π—Ç–∏ –±—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç –∏–ª–∏ –∑–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å –æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–∞—Ö –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞!';
        chatContainer.appendChild(welcomeMsg);
        
        // –û—á–∏—â–∞–µ–º –ø–æ–ª–µ –≤–≤–æ–¥–∞
        chatInput.value = '';
        
        // –û—á–∏—â–∞–µ–º –ø—Ä–µ–≤—å—é –º–µ–¥–∏–∞
        clearMediaPreview();
        
        // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –≤–Ω–∏–∑
        chatContainer.scrollTo({ top: chatContainer.scrollHeight, behavior: 'smooth' });
      }

      function handleChatSubmit(e) {
        e.preventDefault();
        e.stopPropagation();

        const message = chatInput.value.trim();
        const hasMedia = pendingMedia.length > 0;

        if (!message && !hasMedia) return;

        // –ï—Å–ª–∏ –∏–¥–µ—Ç —Ç–µ—Å—Ç, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –æ—Ç–≤–µ—Ç—ã —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫–∏
        if (currentTestState.inProgress) {
          const userMsg = document.createElement('div');
          userMsg.className = 'message user-message animate-fade-in';
          userMsg.textContent = message;
          chatContainer.appendChild(userMsg);
          
          const botMsg = document.createElement('div');
          botMsg.className = 'message bot-message animate-fade-in';
          botMsg.textContent = '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–∏—Ä–∞–π—Ç–µ –æ—Ç–≤–µ—Ç—ã —Å –ø–æ–º–æ—â—å—é –∫–Ω–æ–ø–æ–∫ –≤—ã—à–µ –¥–ª—è —Ç–æ—á–Ω–æ—Å—Ç–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.';
          chatContainer.appendChild(botMsg);
          
          chatInput.value = '';
          chatContainer.scrollTo({ top: chatContainer.scrollHeight, behavior: 'smooth' });
          return;
        }

        // Add user message
        if (message) {
          const userMsg = document.createElement('div');
          userMsg.className = 'message user-message animate-fade-in';
          userMsg.textContent = message;
          chatContainer.appendChild(userMsg);
        }

        // Add media if any
        if (hasMedia) {
          pendingMedia.forEach(media => {
            const mediaMsg = document.createElement('div');
            mediaMsg.className = 'message message-image user-message animate-fade-in';
            mediaMsg.innerHTML = `<img src="${media}" alt="Sent image">`;
            chatContainer.appendChild(mediaMsg);
          });
        }

        // Force DOM update and scroll to bottom
        requestAnimationFrame(() => {
          chatContainer.scrollTo({ top: chatContainer.scrollHeight, behavior: 'smooth' });
        });

        // Clear input and media
        chatInput.value = '';
        clearMediaPreview();

        // Add bot response after delay
        setTimeout(() => {
          const answer = findAnswer(message);
          if (answer) {
            const botMsg = document.createElement('div');
            botMsg.className = 'message bot-message animate-fade-in';
            botMsg.textContent = answer;
            chatContainer.appendChild(botMsg);
            
            requestAnimationFrame(() => {
              chatContainer.scrollTo({ top: chatContainer.scrollHeight, behavior: 'smooth' });
            });
          }
        }, 500);
      }

      // Event listeners
      chatFileInput.addEventListener('change', handleFileInput);
      cancelMediaButton.addEventListener('click', clearMediaPreview);
      chatForm.addEventListener('submit', handleChatSubmit);
      clearChatButton.addEventListener('click', createNewChat);

      chatInput.addEventListener('keypress', (e) => {
        if (e.key === 'Enter' && !e.shiftKey) {
          e.preventDefault();
          handleChatSubmit(e);
        }
      });

      // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π —á–∞—Ç –ø—Ä–∏ –∫–∞–∂–¥–æ–π –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
      createNewChat();
    });
  </script>
</body>
</html>